<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NewFrontPage</title>
    <link rel="icon" href="../Images/favicon.ico">
    <link rel="stylesheet" href="../index.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <link rel="stylesheet" href="PersonalSite.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="PersonalSite.js"></script>
    <script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
</head>
<body>
<header>
    <div class="container">
        <nav>
            <span></span>
            <a href="PersonalSite.html"><img class ="logo" src="../Images/MyHours.svg" alt="Avatar"></a>
            <ul>
                <li><a href="../About/AboutUs.html">About</a></li>
                <li><a href="#">Help</a> </li>
            </ul>
        </nav>
    </div>
    <div class="middle_menu">
        <div class="menu">


            <li class="item" id="profile">
                <input id="myid" type="checkbox" onclick="changeFunction('none'); checkMenu0(); closeInfo();">

                <label for="myid" class="btn_menu"><i class="fas fa-user"></i>Profile</label>
                <div class="smenu">
                    <a href="#">Settings</a>
                </div>
            </li>

            <li class="item" id="shifts" >
                <input id="myid1" type="checkbox" onclick="changeFunction('shifts'); checkMenu1(); openInfo();">

                <label for="myid1" class="btn_menu"><i class="fas fa-sticky-note"></i>Shift</label>
                <div class="smenu">
                    <a href="#">Add</a>
                    <a href="#">Edit</a>
                    <a href="#">Delete</a>
                </div>
            </li>

            <li class="item" id="job" >
                <input id="myid2" type="checkbox" onclick="changeFunction('job'); checkMenu2(); openInfo();">

                <label for="myid2" class="btn_menu"><i class="fas fa-briefcase"></i>Job</label>
                <div class="smenu">
                    <a href="#">Add</a>
                    <a href="#">Edit</a>
                    <a href="#">Delete</a>
                </div>
            </li>
            <li class="item" id="workplace" >
                <input id="myid3" type="checkbox" onclick="changeFunction('workplace'); checkMenu3(); openInfo();">

                <label for="myid3" class="btn_menu"><i class="fas fa-building"></i>Workplace</label>
                <div class="smenu">
                    <a href="#">Add</a>
                    <a href="#">Edit</a>
                    <a href="#">Delete</a>
                </div>
            </li>
            <li class="item">
                <a href="#" class="btn_menu"><i class="fas fa-sign-out-alt"></i>Logout</a>
            </li>
        </div>
    </div>

    <div class="popup_mid">
        <div class="popup_content" id="popup_content" >

            <div class="pop_top" id="pop_top2">
                <center>
                    <h1 id="pop_top_head"></h1>
                </center>

            </div>
            <div class="pop_left">
                <table id="left_table" class="left_table">

                </table>
            </div>
            <div class="pop_right" id="graph"></div>

        </div>
    </div>

</header>

<footer>
    <script type="text/javascript" src="PersonalSite.js"></script>
    <script>
        //her er delene som fremkalder content.
        function openInfo() {

            document.getElementById('popup_content').style.width = '100%';
            document.getElementById('popup_content').style.height = '80%';
            hoursOnWorkMounthly();





        }
        function closeInfo() {
            document.getElementById('popup_content').style.width = '0px';
            document.getElementById('popup_content').style.height = '0px';

        }


        //her er delene som ændre ved content.
        function changeFunction(site) {
            //var elem = document.getElementById('content');
            if (site === 'shifts' && document.getElementById('myid1').checked){
                header('Shifts');
                left('shifts');
                //console.log(site);
            } else if (site === 'job' && document.getElementById('myid2').checked){
                header('Job');
                left('job');
                //console.log(site);
            } else if (site === 'workplace' && document.getElementById('myid3').checked){
                header('Workplace');
                left('workplace');
                //console.log(site);
            } else if(site === 'none' && document.getElementById('myid').checked) {
                header('');
                left('none');
                //console.log(site);
            }else{
                //checkMenu0();
                //closeInfo(); //FIXME Hvis disse 3 bliver aktiveret, vil grafen blive fjernet som forventet, men den klager over rekursion, så har valgt at udkommentere dem for performence skyld (ikke at jeg kunne mærke noget)
                //changeFunction('none');
                header('');
                left('none');
                //console.log(site+" close");
            }
        }

        function header(head) {
            document.getElementById('pop_top_head').innerHTML = head;
            if (head === ''){
                document.getElementById('pop_top2').style.backgroundColor = 'transparent';
            } else {
                document.getElementById('pop_top2').style.backgroundColor = 'rgb(52, 152, 219)';
            }
        }



        function left(type) {
            if (type === 'shifts') {
                shifts();
            }
            if (type === 'job'){
                job();
            }
            if (type === 'workplace') {
                workplace();
            }
            if (type === 'none'){
                none();
            }

        }

        function hoursOnWorkMounthly(){
            anychart.onDocumentReady(function() {


                var today = new Date();
                var mounth = String(today.getMonth());
                var year = today.getFullYear();

                var nrOfDays = daysInMonth(mounth,year);

                // set the data
                var data = {
                    header: ["Date", "Hours"]
                };

                //her finder jeg alle de job som er forbundet med brugeren.
                var nrOfJobs = new Array();
                for (var loop = 0; loop < findNrOfCompanys() ;loop++) {
                    nrOfJobs[loop] = findCompanyId(loop);
                }

                mounth++;

                //laver dataset
                var dataSets = new Array();

                for (var l=0;l<findNrOfCompanys();l++) {
                    var dataSet = anychart.data.set(data);
                    for (var i = 0; i < nrOfDays; i++) {
                        var name = 'Den ' + (i + 1) + '. i ' + (mounth) + '.';
                        dataSet.append([name, hoursOfWork()]);
                    };
                    dataSets[l] = dataSet;
                };




                // create the chart
                var chart = anychart.column()
                chart.animation(true);

                var serieSet = new Array();

                //laver dataen til serie sæt.

                for (var r = 0; r<dataSets.length; r++) {
                    serieSet[r] = dataSets[r].mapAs({'x': 0, 'value': 1})
                }

                chart.yScale().stackMode('value');



                // add the data
                for (var c = 0; c<serieSet.length; c++){
                    chart.column(serieSet[c]);
                }


                var i=0;
                // create a loop
                while (chart.getSeriesAt(i)){
                    // rename each series
                    chart.getSeriesAt(i).name(findWork(nrOfJobs[i]));
                    i++;
                }

                // set the chart title
                chart.title("Hours on work");

                // draw
                chart.container("graph");
                chart.draw();
            });
        }


    </script>
</footer>


</body>
</html>